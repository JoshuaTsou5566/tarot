<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¤§é˜¿çˆ¾å…‹ç´ - å¡”ç¾…å åœ</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            transition: background-color 0.8s ease; 
            margin: 0; 
            padding: 0; 
            overflow-x: hidden; 
            -webkit-tap-highlight-color: transparent;
            font-size: 16px;
            line-height: 1.6;
        }
        .font-serif { font-family: 'Noto Serif TC', serif; }
        ::-webkit-scrollbar { display: none; }
        
        .animate-in { animation: fadeIn 0.6s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        
        /* æ´—ç‰Œå‹•ç•« */
        .card-shuffle { animation: shuffle 0.6s infinite ease-in-out; }
        @keyframes shuffle {
            0%, 100% { transform: rotate(0deg) translate(0, 0) scale(1); }
            25% { transform: rotate(8deg) translate(15px, -10px) scale(1.05); }
            50% { transform: rotate(-8deg) translate(-15px, 10px) scale(0.95); }
            75% { transform: rotate(4deg) translate(8px, 15px) scale(1.02); }
        }

        .btn-press:active { transform: scale(0.95); transition: transform 0.1s; }
        .glass-panel { backdrop-filter: blur(16px); border-width: 1px; }
        .decoration-layer { pointer-events: none; z-index: -1; }
        input, textarea { font-size: 18px !important; border-radius: 24px !important; }
        .no-select { -webkit-user-select: none; user-select: none; }
        
        @media (min-width: 768px) {
            body { font-size: 17px; }
        }
    </style>
</head>
<body class="bg-[#020617]">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // --- 1. SVG åœ–æ¨™è·¯å¾‘ ---
        const ICONS = {
            Sparkles: <><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/></>,
            RefreshCw: <><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M3 21v-5h5"/></>,
            Moon: <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/>,
            Sun: <><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="M4.93 4.93l1.41 1.41"/><path d="M17.66 17.66l1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="M6.34 17.66l-1.11 1.11"/><path d="M19.07 4.93l-1.41 1.41"/></>,
            BookOpen: <><path d="M2 3h6a4 4 0 0 1 4 4v14a4 4 0 0 0-4-4H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a4 4 0 0 1 4-4h6z"/></>,
            Lock: <><rect width="18" height="11" x="3" y="11" rx="2" ry="2" /><path d="M7 11V7a5 5 0 0 1 10 0v4" /></>,
            X: <><line x1="18" y1="6" x2="6" y2="18" /><line x1="6" y1="6" x2="18" y2="18" /></>,
            Share: <><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></>,
            AlertCircle: <><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></>,
            ChevronDown: <polyline points="6 9 12 15 18 9" />,
            Compass: <><circle cx="12" cy="12" r="10"/><path d="m16.24 7.76-2.12 6.36-6.36 2.12 2.12-6.36 6.36-2.12z"/></>,
            Layout: <><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M3 9h18"/><path d="M9 21V9"/></>,
            BrainCircuit: <><path d="M12 4.5V2"/><path d="M18 11h2.5"/><path d="M12 19.5V22"/><path d="M5.5 11H3"/><path d="M12 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z"/><path d="M16 12.5V11a4 4 0 0 0-8 0v1.5"/><path d="M16 8a4 4 0 0 0-8 0"/></>,
            Heart: <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>,
            LogOut: <><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></>,
            ChiikawaHead: <path d="M12 22C6.5 22 2 17.5 2 12C2 8.5 4.5 5.5 8 4.5V2A1.5 1.5 0 0 1 11 2v2c.3-.1.6-.1.9-.1s.7 0 1 .1V2a1.5 1.5 0 0 1 3 0v2.5c3.5 1 6 4 6 7.5 0 5.5-4.5 10-10 10z" fill="currentColor" />,
            HachiwareHead: <path d="M12 22c-5.5 0-10-4.5-10-10 0-3.5 2.5-6.5 6-7.5L6 1l3-1 2 2.5c.3-.1.7-.2 1-.2s.7.1 1 .2L15 0l3 1-2 2.5c3.5 1 6 4 6 7.5 0 5.5-4.5 10-10 10z M9 9l3 3 3-3" fill="currentColor" />,
            UsagiHead: <path d="M12 22c-5.5 0-10-4.5-10-10 0-3.5 2-6.5 5-7.5V0a1.5 1.5 0 0 1 3 0v3.2c.6-.1 1.3-.2 2-.2s1.4.1 2 .2V0a1.5 1.5 0 0 1 3 0v3.5c3 1 5 4 5 7.5 0 5.5-4.5 10-10 10z" fill="currentColor" />
        };

        const TAROT_DATA = [
            { id: 0, numeral: "0", title: "æ„šè€…", meaning: "ç´”çœŸèˆ‡é–‹ç«¯", keywords: ["å†’éšª", "è‡ªç”±", "å‹‡æ°£", "ç„¡é™å¯èƒ½", "èµ¤å­ä¹‹å¿ƒ"], love: ["æ–°æˆ€æƒ…çš„é–‹ç«¯ï¼Œç´”ç²¹ä¸”ç„¡æ‹˜ç„¡æŸã€‚", "éæ–¼é­¯è½ï¼Œå°é—œä¿‚ç¼ºä¹æ‰¿è«¾ã€‚"], social: ["çµäº¤æ–°æœ‹å‹ï¼Œæ°£æ°›è¼•é¬†æ„‰å¿«ã€‚", "å®¹æ˜“è¢«è¦–ç‚ºä¸é è­œæˆ–éæ–¼ä»»æ€§ã€‚"], work: ["é©åˆè½‰è·æˆ–é–‹ç™¼æ–°å‰µæ„ï¼Œå……æ»¿ç†±æƒ…ã€‚", "ç¼ºä¹ç´€å¾‹èˆ‡è¨ˆç•«ï¼Œå®¹æ˜“å‡ºéŒ¯ã€‚"], finance: ["å°é‡‘éŒ¢æŠ±æŒæ¨‚è§€ï¼Œå¯èƒ½æœƒæœ‰æ„å¤–é–‹éŠ·ã€‚", "è²¡å‹™ç‹€æ³ä¸ç©©å®šï¼Œéœ€é˜²ç¯„éåº¦æ¶ˆè²»ã€‚"] },
            { id: 1, numeral: "I", title: "é­”è¡“å¸«", meaning: "å‰µé€ åŠ›èˆ‡æŒæ¡", keywords: ["å‰µæ„", "å¯èƒ½æ€§", "æƒ³åƒåŠ›", "æŒæ¡è³‡æº", "è‡ªç”±è‡ªåœ¨"], love: ["å……æ»¿å¸å¼•åŠ›çš„é–‹ç«¯ï¼Œæºé€šé †æš¢ã€‚", "ç”œè¨€èœœèªèƒŒå¾Œçš„è™›å½ï¼Œç¼ºä¹çœŸå¿ƒã€‚"], social: ["å±•ç¾å€‹äººæ‰è¯ï¼Œæˆç‚ºåœ˜é«”æ ¸å¿ƒã€‚", "å¯èƒ½çµ¦äººæ²¹è…”æ»‘èª¿ã€ä¸èª å¯¦çš„å°è±¡ã€‚"], work: ["å…·å‚™è§£æ±ºå•é¡Œçš„èƒ½åŠ›ï¼Œè¨ˆç•«é †åˆ©æ¨é€²ã€‚", "æŠ€è¡“ä¸æˆç†Ÿæˆ–èƒ½åŠ›ä¸è¶³å»ç¡¬æ’ã€‚"], finance: ["æœ‰èƒ½åŠ›å‰µé€ è²¡å¯Œï¼Œå–„æ–¼ç†è²¡è¦åŠƒã€‚", "æŠ•è³‡é™·é˜±æˆ–è²¡å‹™è³‡è¨Šä¸å°ç¨±ã€‚"] },
            { id: 2, numeral: "II", title: "å¥³ç¥­å¸", meaning: "ç›´è¦ºèˆ‡å¯§éœ", keywords: ["å†·éœ", "æ™ºæ…§", "ç¥ç¥•", "æ½›æ„è­˜", "å…§åœ¨å°å¼•"], love: ["éˆé­‚å±¤é¢çš„å¥‘åˆï¼Œéœå¾…ç™¼å±•ã€‚", "æƒ…ç·’å£“æŠ‘ï¼Œé—œä¿‚ä¸­å­˜åœ¨éš”é–¡ã€‚"], social: ["è¢«è¦–ç‚ºæ˜æ™ºã€å†·éœçš„å‚¾è½è€…ã€‚", "éæ–¼å­¤åƒ»æˆ–ç¥ç¥•ï¼Œè®“äººé›£ä»¥æ¥è¿‘ã€‚"], work: ["æ†‘ç›´è¦ºåšå‡ºæ­£ç¢ºæ±ºç­–ï¼Œé©åˆç ”ç©¶ã€‚", "å¿½è¦–ç´°ç¯€æˆ–éæ–¼æ„Ÿæƒ…ç”¨äº‹ã€‚"], finance: ["ä¿å®ˆç†è²¡ï¼Œè²¡å‹™ç‹€æ³å¹³ç©©ã€‚", "ç†è²¡è³‡è¨Šæ¨¡ç³Šï¼Œå­˜åœ¨éš±è—è™§æã€‚"] },
            { id: 3, numeral: "III", title: "çš‡å", meaning: "è±é¥’èˆ‡æ„›", keywords: ["è±ç››", "æ¯æ€§", "ç¾æ„Ÿ", "äº«æ¨‚", "æº«æŸ”åŒ…å®¹"], love: ["æ„Ÿæƒ…ç”œèœœã€è±æ”¶ï¼Œå¯èƒ½è¿ä¾†æ–°ç”Ÿå‘½ã€‚", "æƒ…æ„Ÿéœ€æ±‚éå¤§ï¼Œç”¢ç”Ÿä¾è³´æˆ–æ§åˆ¶æ„Ÿã€‚"], social: ["æ°£æ°›å’Œè«§ï¼Œå……æ»¿å¥³æ€§åŠ›é‡çš„é—œæ‡·ã€‚", "éæ–¼å˜®å¨æˆ–å¹²æ¶‰ä»–äººç§ç”Ÿæ´»ã€‚"], work: ["å‰µæ„æ³‰æ¹§ï¼Œç’°å¢ƒå……æ»¿åŒ…å®¹åŠ›ã€‚", "é€²åº¦åœæ»¯ä¸å‰ï¼Œéæ–¼è¿½æ±‚å®‰é€¸ã€‚"], finance: ["è²¡é‹æ¥µä½³ï¼Œäº«å—å„ªæ¸¥ç”Ÿæ´»ã€‚", "æ®éœç„¡åº¦ï¼Œå…¥ä¸æ•·å‡ºã€‚"] },
            { id: 4, numeral: "IV", title: "çš‡å¸", meaning: "æ¬Šå¨èˆ‡ç§©åº", keywords: ["æ¬Šå¨", "ç§©åº", "çˆ¶æ¬Š", "ç©©å®š", "å …å®šä¸ç§»"], love: ["é—œä¿‚ç©©å®šï¼Œçµ¦äºˆå°æ–¹æ¥µå¤§çš„å®‰å…¨æ„Ÿã€‚", "å°ˆåˆ¶éœ¸é“ï¼Œç¼ºä¹æƒ…æ„Ÿäº¤æµèˆ‡æŸ”è»Ÿã€‚"], social: ["æ“”ä»»é ˜å°è€…è§’è‰²ï¼Œå—äººæ™¯ä»°ã€‚", "æ¬ŠåŠ›é¬¥çˆ­æˆ–éæ–¼åƒµåŒ–ã€é›£ç›¸è™•ã€‚"], work: ["å»ºç«‹ç³»çµ±ï¼Œäº‹æ¥­æ ¹åŸºç©©å›ºã€‚", "ç®¡ç†å¤±æ•—ï¼Œè¨ˆç•«è¢«åƒµåŒ–çš„è¦å‰‡æŸç¸›ã€‚"], finance: ["ç©©å®šæ”¶å…¥ï¼Œå°ˆæ¥­çš„ç†è²¡æ¶æ§‹ã€‚", "éæ–¼ä¿å®ˆæˆ–å› æ§åˆ¶æ¬²å°è‡´è²¡å‹™æå¤±ã€‚"] },
            { id: 5, numeral: "V", title: "æ•™çš‡", meaning: "å‚³çµ±èˆ‡æ™ºæ…§", keywords: ["æ•™å°", "æ´åŠ©", "ä¿¡ä»°", "è¦ç¯„", "ç²¾ç¥å°å¸«"], love: ["é‡è¦–æ‰¿è«¾ï¼Œé©åˆæ­¥å…¥å©šå§»æˆ–ç©©å®šé—œä¿‚ã€‚", "è§€å¿µåˆ†æ­§ï¼Œè¢«ç¤¾æœƒè¦ç¯„æŸç¸›çš„å£“æŠ‘ã€‚"], social: ["å°‹æ±‚é•·è¼©æˆ–å°å¸«çš„æŒ‡å¼•ï¼Œå—æƒ è‰¯å¤šã€‚", "å®¹æ˜“å› è§€å¿µä¿å®ˆèˆ‡äººç™¼ç”Ÿå£è§’ã€‚"], work: ["éµå¾ªå°ˆæ¥­æµç¨‹ï¼Œç²å¾—å‰è¼©ææ‹”ã€‚", "æ’æ–¥å‰µæ–°ï¼Œè¨ˆç•«éæ–¼è€èˆŠç„¡åŠ›ã€‚"], finance: ["ä¿¡è­½è‰¯å¥½ï¼Œé©åˆç©©å¥é•·æœŸæŠ•è³‡ã€‚", "è²¡å‹™ç³¾ç´›ï¼Œéœ€å°å¿ƒä¿¡è¨—åˆç´„å•é¡Œã€‚"] },
            { id: 6, numeral: "VI", title: "æˆ€äºº", meaning: "é¸æ“‡èˆ‡å¥‘åˆ", keywords: ["å¥‘åˆ", "å¸å¼•åŠ›", "é¸æ“‡", "å’Œè«§", "æƒ…æ„Ÿäº¤è"], love: ["å®Œç¾å’Œè«§çš„æ„›æƒ…ï¼Œåšå‡ºæ­£ç¢ºçš„çµåˆã€‚", "é¢è‡¨é¸æ“‡å›°é›£ï¼Œæ„Ÿæƒ…ä¸­å‡ºç¾ç¬¬ä¸‰è€…èª˜æƒ‘ã€‚"], social: ["å»ºç«‹æ·±åšçš„å‹èª¼ï¼Œåˆä½œç„¡é–“ã€‚", "åƒ¹å€¼è§€è¡çªï¼Œå®¹æ˜“ç™¼ç”Ÿçˆ­åµã€‚"], work: ["é©åˆåˆå¤¥æˆ–åœ˜éšŠå”ä½œï¼Œç›®æ¨™ä¸€è‡´ã€‚", "æ±ºç­–çŒ¶è±«ï¼Œåœ˜éšŠå…§éƒ¨ç”¢ç”Ÿå«Œéš™ã€‚"], finance: ["æ­£ç¢ºçš„æŠ•è³‡æ±ºç­–ï¼Œè²¡é‹å¹³é †ã€‚", "å› æƒ…æ„Ÿå› ç´ å°è‡´ä¸æ™ºçš„è²¡å‹™æ±ºå®šã€‚"] },
            { id: 7, numeral: "VII", title: "æˆ°è»Š", meaning: "æ„å¿—èˆ‡å‹åˆ©", keywords: ["è¡åˆº", "å…‹æœ", "æŒæ§", "æ„å¿—åŠ›", "å¿«é€Ÿç™¼å±•"], love: ["ç©æ¥µä¸»å‹•ï¼ŒæˆåŠŸå…‹æœæƒ…æ„Ÿä¸Šçš„éšœç¤™ã€‚", "æƒ…ç·’å¤±æ§ï¼Œé—œä¿‚ä¸­å‡ºç¾æ¿€çƒˆçš„çˆ­åŸ·ã€‚"], social: ["æ¥µå…·å€‹äººé­…åŠ›ï¼Œå¸¶é ˜åœ˜éšŠå‰é€²ã€‚", "å‰›æ„è‡ªç”¨ï¼Œå®¹æ˜“æ‹›è‡´ä»–äººçš„åæ„Ÿã€‚"], work: ["æ„å¿—å …å®šï¼Œäº‹æ¥­å–å¾—é‡å¤§çªç ´ã€‚", "ç›®æ¨™è¿·å¤±ï¼Œå› ç„¦èºè€Œå°è‡´è¨ˆç•«å¤±æ•—ã€‚"], finance: ["ç©æ¥µé–‹æºï¼Œç›®æ¨™æ˜ç¢ºæ”¶ç›Šå¢é•·ã€‚", "æ”¶æ”¯å¤±è¡¡ï¼Œå› é­¯è²Œæ“´å¼µè€Œè² å‚µã€‚"] },
            { id: 8, numeral: "VIII", title: "åŠ›é‡", meaning: "å‹‡æ°£èˆ‡æ…ˆæ‚²", keywords: ["éŸŒæ€§", "ä¸å±ˆ", "æ…ˆæ‚²", "é¦´æœ", "ä»¥æŸ”å…‹å‰›"], love: ["ä»¥æŸ”å…‹å‰›ï¼ŒæˆåŠŸå°å¼•å°æ–¹çš„æƒ…ç·’ã€‚", "ä¿¡å¿ƒå‹•æ–ï¼Œæ„Ÿåˆ°ç„¡åŠ›ç¶­æŒé€™æ®µé—œä¿‚ã€‚"], social: ["å¾…äººçœŸèª ï¼Œæ“æœ‰å¼·å¤§çš„è¦ªå’ŒåŠ›ã€‚", "å®¹æ˜“å—ä»–äººæƒ…ç·’å‹’ç´¢è€Œæ„Ÿåˆ°ç–²æ†Šã€‚"], work: ["ä¸ç•æŒ‘æˆ°ï¼Œä»¥è€æ€§åŒ–è§£å±æ©Ÿã€‚", "èƒ½åŠ›å—é™ï¼Œé¢å°å£“åŠ›æ™‚é¡¯å¾—è»Ÿå¼±ã€‚"], finance: ["é‡å…¥ç‚ºå‡ºï¼Œæ“æœ‰è‰¯å¥½çš„è²¡å‹™è‡ªåˆ¶åŠ›ã€‚", "è²¡å‹™å¤±æ§ï¼Œè¢«æ…¾æœ›ç‰½è‘—é¼»å­èµ°ã€‚"] },
            { id: 9, numeral: "IX", title: "éš±è€…", meaning: "å…§çœèˆ‡æ™ºæ…§", keywords: ["å…§çœ", "å­¤ç¨", "æ¢ç´¢", "å°å¼•", "å¿ƒéˆæˆé•·"], love: ["äº«å—ç¨è™•ï¼Œæˆ–èˆ‡ä¼´ä¾¶é€²è¡Œæ·±åº¦å¿ƒéˆå°è©±ã€‚", "éåº¦å­¤ç«‹ï¼Œæ‹’çµ•å°å¤–æºé€šè€Œç”¢ç”Ÿéš”é–¡ã€‚"], social: ["æ·¡æ³Šç¤¾äº¤ï¼Œå°ˆæ³¨æ–¼å…§åœ¨çš„æˆé•·ã€‚", "è¢«é‚Šç·£åŒ–æˆ–æ„Ÿåˆ°å¯‚å¯ï¼Œæ‹’çµ•ç¤¾äº¤ã€‚"], work: ["æ·±è€•å°ˆæ¥­é ˜åŸŸï¼Œæ™ºæ…§å°‡å¸¶ä¾†æˆåŠŸã€‚", "é€²åº¦é²ç·©ï¼Œéæ–¼å°ˆæ³¨ç´°ç¯€è€Œå¿½ç•¥å¤§å±€ã€‚"], finance: ["æ·¡æ¬²ç†è²¡ï¼Œè²¡å‹™ç‹€æ³å°šå¯ã€‚", "éæ–¼å°æ°£æˆ–å› å°é–‰è³‡è¨ŠéŒ¯å¤±å•†æ©Ÿã€‚"] },
            { id: 10, numeral: "X", title: "å‘½é‹ä¹‹è¼ª", meaning: "é€±æœŸèˆ‡è½‰æ©Ÿ", keywords: ["è½‰æŠ˜", "è¼ªè¿´", "å‘½é‹", "é€±æœŸ", "ä¸å¯æŠ—åŠ›"], love: ["å‘½é‹çš„å®‰æ’ï¼Œé—œä¿‚è¿ä¾†æ­£å‘è½‰æŠ˜ã€‚", "é‹æ°£ä¸ä½³ï¼Œæƒ…æ„Ÿé€²å…¥åœæ»¯çš„ä½æ½®æœŸã€‚"], social: ["ç¤¾äº¤åœˆæ›´è¿­ï¼Œè¿ä¾†æœ‰åŠ©ç›Šçš„æ–°æœ‹å‹ã€‚", "äººéš›é—œä¿‚åè¦†ç„¡å¸¸ï¼Œé›£ä»¥æ‰æ‘¸ã€‚"], work: ["æ™‚ä¾†é‹è½‰ï¼ŒæŒæ¡é—œéµçš„æ™‰å‡æ©Ÿæœƒã€‚", "é˜»ç¤™é‡é‡ï¼Œç¾ç‹€é›£ä»¥è¢«è‡ªå·±æŒæ§ã€‚"], finance: ["è²¡é‹å›å‡ï¼Œæœ‰æ„å¤–çš„ä¸­çæ©Ÿæœƒã€‚", "æŠ•è³‡è™§æï¼Œè²¡å‹™é€±æœŸé™·å…¥ä¸é †ã€‚"] },
            { id: 11, numeral: "XI", title: "æ­£ç¾©", meaning: "å…¬å¹³èˆ‡å¹³è¡¡", keywords: ["å…¬æ­£", "çœŸç†", "è²¬ä»»", "è£æ±º", "å¹³è¡¡ç™¼å±•"], love: ["èª å¯¦å°å¾…å½¼æ­¤ï¼Œåšå‡ºå…¬å¹³çš„æ±ºç­–ã€‚", "é¢è‡¨å†·æˆ°ï¼Œé—œä¿‚ä¸­å­˜åœ¨æ˜é¡¯çš„ä¸å¹³ç­‰ã€‚"], social: ["è™•äº‹å…¬æ­£ï¼Œæˆç‚ºæœ‹å‹é–“çš„èª¿è§£äººã€‚", "é­å—åè¦‹æˆ–èª¤è§£ï¼Œæ„Ÿåˆ°å§”å±ˆã€‚"], work: ["ä¸€åˆ‡ç…§åˆ¶åº¦åŸ·è¡Œï¼Œç²å¾—æ‡‰æœ‰çš„å›é¥‹ã€‚", "æ±ºç­–å¤±æº–ï¼Œéœ€æ‰¿æ“”éå»éŒ¯èª¤çš„å¾Œæœã€‚"], finance: ["è²¡å‹™å¹³è¡¡ï¼Œæ”¶æ”¯å¸³ç›®æ¸…æ™°ã€‚", "è²¡å‹™çˆ­è­°ï¼Œå¯èƒ½é¢è‡¨å®˜å¸æˆ–åˆç´„å•é¡Œã€‚"] },
            { id: 12, numeral: "XII", title: "å€’åŠäºº", meaning: "çŠ§ç‰²èˆ‡è¦ºé†’", keywords: ["ç­‰å¾…", "è¦ºæ‚Ÿ", "æ–°è¦–è§’", "å¥‰ç»", "æš«æ™‚åœæ»¯"], love: ["æ›ä½æ€è€ƒï¼Œåœ¨ç­‰å¾…ä¸­ç²å¾—æƒ…æ„Ÿæ˜‡è¯ã€‚", "å¾’å‹ç„¡åŠŸçš„çŠ§ç‰²ï¼Œè¢«å‹•æ¥å—ç—›è‹¦ã€‚"], social: ["å¯§é¡˜åƒè™§ä¹Ÿè¦æˆå°±å¤§å±€çš„æ…·æ…¨ã€‚", "æ„Ÿåˆ°è¢«å‘¨åœçš„äººåˆ©ç”¨ï¼Œå…§å¿ƒæŠ‘é¬±ã€‚"], work: ["æš«æ™‚çš„æ²‰å¯‚æ˜¯ç‚ºäº†è“„ç©æ›´å¤§çš„èƒ½é‡ã€‚", "è¨ˆç•«åœæ»¯ï¼Œåšå†å¤šä¹Ÿçœ‹ä¸åˆ°å›å ±ã€‚"], finance: ["è²¡å‹™ç·©æ…¢ç™¼å±•ï¼Œéœ€ä¿æŒè€å¿ƒã€‚", "è³‡é‡‘å‡çµï¼Œå› åˆ¤æ–·å°è‡´è²¡å‹™å›°å¢ƒã€‚"] },
            { id: 13, numeral: "XIII", title: "æ­»ç¥", meaning: "çµ‚çµèˆ‡æ–°ç”Ÿ", keywords: ["å‘Šåˆ¥", "è½‰åŒ–", "çµæŸ", "é‡ç”Ÿ", "å¤§è®Šå‹•"], love: ["å¾¹åº•å‘Šåˆ¥éå»ï¼Œè¿æ¥å…¨æ–°çš„æˆ€æ„›è§€ã€‚", "æ­»å®ˆä¸€æ®µæœ‰å®³çš„é—œä¿‚ï¼Œæ‹’çµ•æ”¹è®Šã€‚"], social: ["äººéš›åœˆå¤§æ´—ç‰Œï¼Œé‡æ–°å¯©è¦–æœ‹å‹åœˆã€‚", "å°ç¤¾äº¤æ„Ÿåˆ°çµ•æœ›ï¼Œå…§å¿ƒå……æ»¿é™°å½±ã€‚"], work: ["èˆŠè¨ˆç•«çµ‚çµï¼Œäº‹æ¥­è¿ä¾†é‡å¤§è½‰æ©Ÿã€‚", "è¢«è¿«è½‰è·æˆ–å€’é–‰ï¼Œå…§å¿ƒæ¥µåº¦ä¸å®‰ã€‚"], finance: ["çµç®—èˆŠå¸³ï¼Œé‡æ–°è¦åŠƒç†è²¡æ–¹å‘ã€‚", "è²¡å‹™å´©æ½°ï¼Œçªå¦‚å…¶ä¾†çš„åš´é‡è™§æã€‚"] },
            { id: 14, numeral: "XIV", title: "ç¯€åˆ¶", meaning: "å¹³è¡¡èˆ‡èª¿å’Œ", keywords: ["è€å¿ƒ", "åœ“è", "èª¿å’Œ", "å¹³è¡¡", "æºé€š"], love: ["å¿ƒéˆäº¤æµé †æš¢ï¼Œæƒ…æ„Ÿæº«å’Œä¸”é•·ä¹…ã€‚", "æºé€šå¤±éˆï¼Œæƒ…ç·’èµ·ä¼éå¤§å½±éŸ¿é—œä¿‚ã€‚"], social: ["äººéš›é—œä¿‚åœ“èï¼Œå–„æ–¼æ•´åˆè³‡æºã€‚", "é »ç‡ä¸å°ï¼Œèˆ‡å‘¨é­çš„äººæ ¼æ ¼ä¸å…¥ã€‚"], work: ["å”ä½œé †åˆ©ï¼Œäº‹ç‰©æ­£ç©©å®šæˆé•·ã€‚", "è³‡æºæµªè²»ï¼Œå„éƒ¨é–€ä¹‹é–“ç¼ºä¹é»˜å¥‘ã€‚"], finance: ["ç©©å¥ç†è²¡ï¼Œè²¡å¯Œç©©å®šç´¯ç©ä¸­ã€‚", "é–‹æ”¯æ··ç·´ï¼Œç„¡æ³•é”åˆ°æ”¶æ”¯å¹³è¡¡ã€‚"] },
            { id: 15, numeral: "XV", title: "æƒ¡é­”", meaning: "æ…¾æœ›èˆ‡æŸç¸›", keywords: ["èª˜æƒ‘", "ç‰©æ…¾", "æŸç¸›", "æ²ˆæºº", "é™°æš—é¢"], love: ["å¼·çƒˆå¸å¼•åŠ›ï¼Œä½†ä¼´éš¨è‘—è‚‰æ…¾èˆ‡åˆ¶ç´„ã€‚", "æ„è­˜åˆ°é—œä¿‚çš„æœ‰å®³ï¼Œæ­£å°‹æ±‚è§£è„«ã€‚"], social: ["æ²ˆæººæ–¼ç©æ¨‚ç¤¾äº¤ï¼Œå®¹æ˜“è¢«å¸¶å£ã€‚", "çœ‹ç©¿ä»–äººçš„è™›å½ï¼Œé é›¢ä¸å¥åº·çš„ç¤¾äº¤ã€‚"], work: ["å°æ¬ŠåŠ›æœ‰æ¥µå¤§åŸ·å¿µï¼Œå¯èƒ½æ¡å–æ¥µç«¯æ‰‹æ³•ã€‚", "å¾ç¹é‡çš„å·¥ä½œå£“åŠ›ä¸­ç²å¾—é‡‹æ”¾ã€‚"], finance: ["è²¡å¯Œæ…¾æœ›å¼·å¤§ï¼Œå¯èƒ½æœƒæœ‰æ©«è²¡ã€‚", "é™·å…¥è²¡å‹™é™·é˜±æˆ–å‚µå‹™æ³¥æ²¼ã€‚"] },
            { id: 16, numeral: "XVI", title: "å¡”", meaning: "åŠ‡è®Šèˆ‡å•Ÿç¤º", keywords: ["å´©è§£", "è¡æ“Š", "éœ‡æ’¼", "æ­ç©¿è™›å‡", "é‡æ–°å•Ÿå‹•"], love: ["æ„Ÿæƒ…ç™¼ç”ŸåŠ‡çƒˆè¡æ“Šï¼ŒçœŸç›¸å¤§ç™½ã€‚", "åƒ¥å€–é€ƒéä¸€åŠ«ï¼Œä½†é—œä¿‚å·²å‡ºç¾è£‚ç—•ã€‚"], social: ["æœ‹å‹åœˆç™¼ç”Ÿé‡å¤§çˆ­åŸ·ï¼Œé—œä¿‚å´©è§£ã€‚", "ç·©æ…¢çš„è¡°æ•—ï¼Œæ„Ÿè¦ºæœ‹å‹é–“æ¼¸è¡Œæ¼¸é ã€‚"], work: ["è¨ˆç•«çªç„¶å‘Šå¹ï¼Œå¿…é ˆå¾å»¢å¢Ÿé‡èµ·ã€‚", "æ„è­˜åˆ°å±æ©Ÿå­˜åœ¨ï¼Œéœ€ç«‹å³èª¿æ•´é˜²ç¦¦ã€‚"], finance: ["çªå¦‚å…¶ä¾†çš„ç ´ç”¢æˆ–é‡å¤§æå¤±ã€‚", "å‹‰å¼·ç¶­æŒå¹³è¡¡ï¼Œä½†å·²æ˜¯å¼·å¼©ä¹‹æœ«ã€‚"] },
            { id: 17, numeral: "XVII", title: "æ˜Ÿæ˜Ÿ", meaning: "å¸Œæœ›èˆ‡ç™‚ç™’", keywords: ["éˆæ„Ÿ", "å¹³éœ", "ç™‚ç™’", "å±•æœ›", "ç´”æ·¨"], love: ["å……æ»¿æœªä¾†çš„æ†§æ†¬ï¼Œæ„Ÿæƒ…å¾—åˆ°æ²»ç™’ã€‚", "é¡˜æ™¯ç ´è£‚ï¼Œå°æ„›æƒ…æ„Ÿåˆ°å¤±æœ›èˆ‡è©•æ†Šã€‚"], social: ["å±•ç¾çœŸå¯¦è‡ªæˆ‘ï¼Œå¸å¼•å¿—åŒé“åˆè€…ã€‚", "æ„Ÿåˆ°å­¤å‚²æˆ–è¢«å¤–ç•Œå¿½è¦–ï¼Œå¤±å»å…‰èŠ’ã€‚"], work: ["éˆæ„Ÿè±æ²›ï¼Œæ‰¾åˆ°é•·é ç™¼å±•çš„æ–¹å‘ã€‚", "è¨ˆç•«ä¸åˆ‡å¯¦éš›ï¼Œæ·ªç‚ºç©ºè«‡ã€‚"], finance: ["è²¡é‹å¹³é †ï¼Œç†è²¡æ–¹å‘å……æ»¿å¸Œæœ›ã€‚", "è²¡å‹™é¡˜æ™¯é™ä¸å¯åŠï¼Œéœ€å›æ­¸ç¾å¯¦ã€‚"] },
            { id: 18, numeral: "XVIII", title: "æœˆäº®", meaning: "ä¸å®‰èˆ‡æ½›æ„è­˜", keywords: ["ä¸å®‰", "æ¨¡ç³Š", "å¤¢å¢ƒ", "æ¬ºç", "å…§åœ¨ææ‡¼"], love: ["æƒ…æ„Ÿæ¨¡ç³Šä¸æ¸…ï¼Œå­˜åœ¨éš±çæˆ–å¹»è¦ºã€‚", "è¿·éœ§æ•£å»ï¼Œçœ‹æ¸…äº†æ„Ÿæƒ…ä¸­çš„çœŸç›¸ã€‚"], social: ["å°äººä½œç¥Ÿï¼Œäººéš›é—œä¿‚å……æ»¿çŒœå¿Œã€‚", "å…§å¿ƒçš„ç„¦æ…®æ¸›è¼•ï¼Œä¸å†ç–‘ç¥ç–‘é¬¼ã€‚"], work: ["è³‡è¨Šä¸æ˜ï¼Œéœ€è­¦æƒ•éš±è—çš„é™·é˜±ã€‚", "è§£æ±ºäº†å·¥ä½œä¸­çš„æ›–æ˜§åœ°å¸¶ã€‚"], finance: ["è²¡å‹™ç‹€æ³æ¨¡ç³Šï¼Œä¸å®œé€²è¡ŒæŠ•è³‡ã€‚", "ç™¼ç¾å¸³ç›®ä¸Šçš„æ¼æ´æˆ–æ¬ºè©ã€‚"] },
            { id: 19, numeral: "XIX", title: "å¤ªé™½", meaning: "å…‰æ˜èˆ‡æˆåŠŸ", keywords: ["å–œæ‚…", "æ´»åŠ›", "æˆåŠŸ", "å…‰æ˜æ­£å¤§", "ç†±æƒ…"], love: ["æˆ€æƒ…å…¬é–‹å—ç¥ç¦ï¼Œé—œä¿‚å……æ»¿æ´»åŠ›ã€‚", "éæ–¼è‡ªè² ï¼Œå…‰èŠ’åˆºçœ¼è®“ä¼´ä¾¶æ„Ÿåˆ°å£“æŠ‘ã€‚"], social: ["å»£å—æ­¡è¿ï¼Œäººéš›é—œä¿‚ç‡¦çˆ›å¥ªç›®ã€‚", "ç‚ºäº†é¢å­è€Œå¼·é¡æ­¡ç¬‘ï¼Œå…§å¿ƒç–²ç´¯ã€‚"], work: ["äº‹æ¥­å¦‚æ—¥ä¸­å¤©ï¼Œç²å¾—é¡¯è‘—çš„æˆå°±æ„Ÿã€‚", "æˆåŠŸå¾Œçš„å€¦æ€ ï¼Œæˆ–é­é‡çŸ­æš«çš„æŒ«æ•—ã€‚"], finance: ["æ”¶å…¥è±åšï¼Œè²¡é‹æ—ºç››ä¸”ç©©å®šã€‚", "æš«æ™‚æ€§çš„è²¡å‹™åƒç·Šï¼Œéœ€é–‹ç¯€ç´„æµã€‚"] },
            { id: 20, numeral: "XX", title: "å¯©åˆ¤", meaning: "å¾©æ´»èˆ‡æ„Ÿå¬", keywords: ["è¦ºé†’", "åçœ", "å†ç”Ÿ", "é‡è¦æ±ºå®š", "æ¸…ç®—"], love: ["ç ´é¡é‡åœ“ï¼Œæˆ–é—œä¿‚å‡ç´šåˆ°æ–°é«˜åº¦ã€‚", "æ‹’çµ•é¢å°éå»çš„éŒ¯èª¤ï¼Œé‡è¹ˆè¦†è½ã€‚"], social: ["é€éè‡ªæˆ‘åçœï¼Œæ”¹å–„äº†èˆ‡äººçš„é—œä¿‚ã€‚", "é­å—èˆ†è«–æ‰¹è©•æˆ–ä»–äººçš„è² é¢æŒ‡é»ã€‚"], work: ["ç²çŸ¥é—œéµæ¶ˆæ¯ï¼Œäº‹æ¥­ç²å¾—æ–°ç”Ÿæ©Ÿæœƒã€‚", "éŒ¯å¸«è‰¯æ©Ÿï¼Œç„¡æ³•å¾éå»çš„å¤±æ•—ä¸­å­¸ç¿’ã€‚"], finance: ["è²¡å‹™ç‹€æ³çµç®—ï¼Œç²å¾—æ­£å‘æœå¯¦ã€‚", "è²¡å‹™å¯©è¨ˆå‡ºå•é¡Œï¼Œéœ€æ‰¿æ“”éå»å¾Œæœã€‚"] },
            { id: 21, numeral: "XXI", title: "ä¸–ç•Œ", meaning: "åœ“æ»¿èˆ‡æ•´åˆ", keywords: ["é”æˆ", "åœ“æ»¿", "æ•´åˆ", "å®Œç¾", "å…¨çƒæ€§"], love: ["éˆé­‚ä¼´ä¾¶ï¼Œæƒ…æ„Ÿç”Ÿæ´»é”åˆ°å®Œç¾å¢ƒåœ°ã€‚", "å·®ä¸€é»é»å°±åœ“æ»¿ï¼Œå­˜åœ¨æœªç«Ÿä¹‹å¿—ã€‚"], social: ["æ“æœ‰å»£é—Šçš„äººè„ˆï¼Œç¤¾äº¤ç„¡å¾€ä¸åˆ©ã€‚", "äººéš›åœˆé›–ç„¶å¤§ï¼Œä½†æ„Ÿåˆ°å¿ƒéˆç©ºè™›ã€‚"], work: ["è¨ˆç•«åœ“æ»¿é”æˆï¼Œè´å¾—æ¥­ç•Œæ¥µé«˜è²è­½ã€‚", "é€²åº¦å³å°‡å®Œæˆä½†æœ€å¾Œé—œé ­ç”¢ç”Ÿæ‹–å»¶ã€‚"], finance: ["è²¡å¯Œé”åˆ°é æœŸç›®æ¨™ï¼Œè²¡å‹™è‡ªç”±ã€‚", "è²¡å¯Œç´¯ç©å—é˜»ï¼Œç„¡æ³•çªç ´æœ€å¾Œç“¶é ¸ã€‚"] }
        ];

        const CHIIKAWA_IMAGES = {
            0: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/0.jpg",
            1: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/1.jpg",
            2: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/2.jpg",
            3: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/3.jpg",
            4: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/4.jpg",
            5: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/5.jpg",
            6: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/6.jpg",
            7: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/7.jpg",
            8: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/8.jpg",
            9: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/9.jpg",
            10: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/10.jpg",
            11: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/11.jpg",
            12: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/12.jpg",
            13: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/13.jpg",
            14: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/14.jpg",
            15: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/15.jpg",
            16: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/16.jpg",
            17: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/17.jpg",
            18: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/18.jpg",
            19: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/19.jpg",
            20: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/20.jpg",
            21: "https://raw.githubusercontent.com/JoshuaTsou5566/tarot/refs/heads/main/21.jpg"
        };

        // --- 4. ä¸»ç¨‹å¼ App ---
        const App = () => {
            const [activeTab, setActiveTab] = useState('divination');
            const [theme, setTheme] = useState('night');
            const [gameState, setGameState] = useState('idle');
            const [spreadType, setSpreadType] = useState('one');
            const [userQuestion, setUserQuestion] = useState('');
            const [selectedCards, setSelectedCards] = useState([]);
            const [aiResponse, setAiResponse] = useState('');
            const [isAiLoading, setIsAiLoading] = useState(false);
            const [secretClickCount, setSecretClickCount] = useState(0);
            
            const [isSetupVisible, setIsSetupVisible] = useState(false);
            const [isShareLinkOpen, setIsShareLinkOpen] = useState(false);
            const [unlockPassInput, setUnlockPassInput] = useState('');
            const [masterApiKey, setMasterApiKey] = useState(localStorage.getItem('arcanum_master_key') || '');
            const [masterPass, setMasterPass] = useState(localStorage.getItem('arcanum_master_pass') || '');
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [isUnlocking, setIsUnlocking] = useState(false);
            const [zoomedImage, setZoomedImage] = useState(null);
            const [message, setMessage] = useState(null);

            // --- å…§éƒ¨çš„çµ„ä»¶å®šç¾© (å°è£åœ¨ App å…§) ---
            const Icon = ({ name, size = 24, className = "" }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {ICONS[name] || null}
                </svg>
            );

            // åŠ å¯†æˆæ¬Šå·¥å…·
            const encodeKey = (key, pass) => btoa(unescape(encodeURIComponent(key + "|" + pass)));
            const decodeKey = (encoded) => {
                try {
                    const decoded = decodeURIComponent(escape(atob(encoded)));
                    const [key, pass] = decoded.split('|');
                    return { key, pass };
                } catch (e) { return null; }
            };

            useEffect(() => {
                const params = new URLSearchParams(window.location.search);
                const authData = params.get('auth');
                if (authData) {
                    const result = decodeKey(authData);
                    if (result) {
                        localStorage.setItem('arcanum_master_key', result.key);
                        localStorage.setItem('arcanum_master_pass', result.pass);
                        setMasterApiKey(result.key);
                        setMasterPass(result.pass);
                        window.history.replaceState({}, document.title, window.location.pathname);
                        setMessage({text: "æˆæ¬Šé€£çµå·²ç”Ÿæ•ˆï¼è«‹è¼¸å…¥è¨ªå•å¯†ç¢¼é–‹å§‹å åœã€‚", type: 'success'});
                    }
                }
            }, []);

            const themeStyles = useMemo(() => {
                const styles = {
                    night: { 
                        bg: "bg-[#020617]", text: "text-slate-100", glow1: "bg-indigo-900", glow2: "bg-purple-900", navBg: "bg-slate-900/80", cardBg: "bg-slate-900", btnBg: "bg-white text-slate-950 shadow-xl", 
                        inputBg: "bg-white/5", inputBorder: "border-white/20", focusBorder: "focus:border-indigo-500", accent: "#818cf8" 
                    },
                    day: { 
                        bg: "bg-[#fffbeb]", text: "text-slate-800", glow1: "bg-amber-200", glow2: "bg-orange-200", navBg: "bg-white/80", cardBg: "bg-white", btnBg: "bg-slate-900 text-white shadow-xl", 
                        inputBg: "bg-black/5", inputBorder: "border-slate-300", focusBorder: "focus:border-orange-500", accent: "#ea580c" 
                    },
                    'chiikawa-pink': { 
                        bg: "bg-[#EFA5C9]", text: "text-[#5D2E46]", glow1: "bg-white/40", glow2: "bg-[#FADDE9]", navBg: "bg-white/70", cardBg: "bg-white", btnBg: "bg-[#D64E8B] text-white shadow-lg", 
                        inputBg: "bg-white/60", inputBorder: "border-[#D64E8B]/40", focusBorder: "focus:border-[#D64E8B]", accent: "#D64E8B" 
                    },
                    'chiikawa-blue': { 
                        bg: "bg-[#91A8D0]", text: "text-[#1B2A4E]", glow1: "bg-white/40", glow2: "bg-[#D1DCEE]", navBg: "bg-white/70", cardBg: "bg-white", btnBg: "bg-[#3D5A80] text-white shadow-lg", 
                        inputBg: "bg-white/60", inputBorder: "border-[#3D5A80]/40", focusBorder: "focus:border-[#3D5A80]", accent: "#3D5A80" 
                    },
                    'chiikawa-yellow': { 
                        bg: "bg-[#FFF9D4]", text: "text-[#4D432A]", glow1: "bg-white/50", glow2: "bg-[#FEF5BC]", navBg: "bg-white/70", cardBg: "bg-white", btnBg: "bg-[#96831A] text-white shadow-xl", 
                        inputBg: "bg-white/60", inputBorder: "border-[#96831A]/40", focusBorder: "focus:border-[#96831A]", accent: "#96831A" 
                    }
                };
                return styles[theme];
            }, [theme]);

            const isChiMode = theme.startsWith('chiikawa');

            const handleSecretClick = () => {
                const next = secretClickCount + 1;
                if (next >= 5) {
                    setTheme('chiikawa-pink');
                    setSecretClickCount(0);
                    setMessage({text: "éš±è—ä¸»é¡Œå·²é–‹å•Ÿï¼", type: 'success'});
                } else {
                    setSecretClickCount(next);
                }
            };

            const toggleTheme = () => {
                if (theme === 'chiikawa-pink') setTheme('chiikawa-blue');
                else if (theme === 'chiikawa-blue') setTheme('chiikawa-yellow');
                else if (theme === 'chiikawa-yellow') setTheme('chiikawa-pink');
                else setTheme(prev => prev === 'night' ? 'day' : 'night');
            };

            const drawCards = () => {
                if (!userQuestion.trim()) {
                    setMessage({text: "è«‹å…ˆè¼¸å…¥æ‚¨æƒ³å•çš„äº‹æƒ…ï¼Œè®“å®‡å®™èƒ½é‡èƒ½ç²¾ç¢ºå°é½Šæ‚¨çš„å›°æƒ‘ã€‚", type: 'error'});
                    return;
                }
                setIsAuthenticated(false); setAiResponse(''); setUnlockPassInput(''); setGameState('shuffling');
                setTimeout(() => {
                    const count = spreadType === 'one' ? 1 : 3;
                    const drawn = [...TAROT_DATA].sort(() => Math.random() - 0.5).slice(0, count).map(c => ({
                        ...c, isReversed: Math.random() > 0.35
                    }));
                    setSelectedCards(drawn); setGameState('revealed');
                }, 2000);
            };

            const resetGame = () => {
                setGameState('idle'); setSelectedCards([]); setAiResponse(''); setUserQuestion('');
                setIsAuthenticated(false); setUnlockPassInput('');
            };

            const handleUnlock = async () => {
                if (!masterApiKey || !masterPass) { 
                    setMessage({text: "è£ç½®æœªæˆæ¬Šã€‚è«‹å¾åŸå§‹é›»è…¦ç«¯ç”Ÿæˆé€£çµå‚³çµ¦æ‰‹æ©Ÿé»é–‹ä¸€æ¬¡ã€‚", type: 'error'}); 
                    return; 
                }
                if (unlockPassInput.trim() === masterPass) {
                    setIsAuthenticated(true);
                    setIsAiLoading(true);
                    const details = selectedCards.map(c => `${c.title}(${c.isReversed?'é€†ä½':'æ­£ä½'})`).join(',');
                    const prompt = `ä½ æ˜¯ä¸€ä½å°ˆæ¥­å¡”ç¾…å¤§å¸«ã€‚å•é¡Œï¼š${userQuestion}ã€‚ç‰Œçµ„ï¼š${details}ã€‚çµ¦äºˆ300å­—æš–å¿ƒè§£è®€ï¼Œåš´ç¦Markdownç¬¦è™Ÿã€‚`;
                    try {
                        const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${masterApiKey}`, {
                            method: 'POST', headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                        });
                        const data = await res.json();
                        setAiResponse(data.candidates?.[0]?.content?.parts?.[0]?.text.replace(/[*#]/g, '').trim() || "æ„Ÿæ‡‰ä¸­...");
                    } catch (e) { setAiResponse("èƒ½é‡æ„Ÿæ‡‰ç¨æœ‰å»¶é²ï¼Œè«‹çœ‹åŸºæœ¬è§£æã€‚"); }
                    finally { setIsAiLoading(false); }
                } else { 
                    setMessage({text: "è¨ªå•å¯†ç¢¼éŒ¯èª¤ã€‚", type: 'error'});
                }
            };

            const handleSaveMaster = () => {
                if (masterApiKey && masterPass) {
                    localStorage.setItem('arcanum_master_key', masterApiKey);
                    localStorage.setItem('arcanum_master_pass', masterPass);
                    setIsSetupVisible(false);
                    setMessage({text: "è¨­å®šæˆåŠŸï¼ç¾åœ¨å¯ç”Ÿæˆåˆ†äº«é€£çµã€‚", type: 'success'});
                }
            };

            // --- å…§éƒ¨å­çµ„ä»¶ ---
            const TarotCard = ({card, idx}) => (
                <div key={idx} className="flex flex-col items-center gap-4 animate-in" style={{animationDelay: `${idx*150}ms`}}>
                    <div className={`relative w-44 h-72 md:w-52 md:h-80 rounded-xl p-0.5 bg-gradient-to-br from-white/80 to-white/20 shadow-2xl ${card.isReversed ? 'rotate-180' : ''}`}>
                        <div className={`w-full h-full ${themeStyles.cardBg} rounded-lg flex flex-col items-center justify-between relative overflow-hidden transition-colors duration-1000`}>
                            <div className="absolute top-2 left-3 text-[10px] opacity-30 font-serif z-10">{card.numeral}</div>
                            <div className="flex-1 w-full relative group">
                                {isChiMode ? (
                                    <div className="w-full h-full flex items-center justify-center p-2 cursor-zoom-in" onClick={() => setZoomedImage(CHIIKAWA_IMAGES[card.id])}>
                                        <img src={CHIIKAWA_IMAGES[card.id]} className="w-full h-full object-contain opacity-90 transition-all hover:scale-105" alt={card.title} />
                                    </div>
                                ) : (
                                    <div className="w-full h-full flex flex-col items-center justify-center space-y-3 pt-6 transition-colors duration-1000"><Icon name={card.id === 19 ? "Sun" : (card.id === 18 ? "Moon" : "Star")} size={56} className="opacity-30" /><div className="text-center font-bold tracking-widest text-lg">{card.title}</div></div>
                                )}
                            </div>
                            <div className={`w-full py-2 px-3 text-center z-10 ${isChiMode ? 'bg-black/60 backdrop-blur-md' : ''}`}>
                                {isChiMode && <div className="text-[11px] font-bold tracking-widest text-white">{card.title}</div>}
                                <div className={`text-[8px] uppercase font-mono tracking-widest ${isChiMode ? 'text-white/50' : 'opacity-20'}`}>TAROT ORACLE</div>
                            </div>
                        </div>
                    </div>
                    <span className="text-[10px] uppercase opacity-60 font-bold tracking-widest">{card.isReversed ? 'é€†ä½' : 'æ­£ä½'}</span>
                </div>
            );

            const CardDetailGrid = ({card, isReversed}) => {
                const idx = isReversed ? 1 : 0;
                return (
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        {[
                            { label: 'ğŸ’• æˆ€æ„›é—œä¿‚', key: 'love' },
                            { label: 'ğŸ¤ äººéš›ç¤¾äº¤', key: 'social' },
                            { label: 'ğŸ’¼ å·¥ä½œå­¸æ¥­', key: 'work' },
                            { label: 'ğŸ’° è²¡å‹™ç‹€æ³', key: 'finance' }
                        ].map(area => (
                            <div key={area.key} className="p-5 rounded-[2rem] bg-black/10 border border-white/5 space-y-3">
                                <h5 className="text-[11px] font-bold opacity-80 border-b border-white/10 pb-2.5 uppercase tracking-widest">{area.label}</h5>
                                <p className="text-sm md:text-base opacity-75 leading-relaxed italic text-justify">{card[area.key][idx]}</p>
                            </div>
                        ))}
                    </div>
                );
            };

            const EncyclopediaCard = ({card}) => {
                const [isOpen, setIsOpen] = useState(false);
                return (
                    <div className={`${themeStyles.cardBg} border ${themeStyles.inputBorder} rounded-[2.5rem] overflow-hidden transition-all shadow-md`}>
                        <button onClick={() => setIsOpen(!isOpen)} className="w-full p-6 flex items-center justify-between text-left active:bg-white/10">
                            <div className="flex items-center gap-5">
                                <span className="text-sm font-serif opacity-20 w-6">{card.numeral}</span>
                                <div className="flex flex-col">
                                    <span className="font-bold tracking-widest text-lg md:text-xl">{card.title}</span>
                                    <div className="flex flex-wrap gap-2.5 mt-2.5">
                                        {card.keywords.map((kw, i) => (
                                            <span key={i} className="text-[11px] md:text-xs font-bold bg-indigo-500/20 text-indigo-400 px-3 py-1 rounded-full border border-indigo-500/10 transition-all">#{kw}</span>
                                        ))}
                                    </div>
                                </div>
                            </div>
                            <Icon name="ChevronDown" size={20} className={`transition-transform duration-300 ${isOpen ? 'rotate-180' : ''}`} />
                        </button>
                        {isOpen && (
                            <div className="p-8 md:p-10 bg-white/5 border-t border-white/5 space-y-10 animate-in">
                                <div><h4 className="text-sm md:text-base font-bold mb-6 text-emerald-400 flex items-center gap-2 uppercase tracking-widest"><span className="w-2.5 h-2.5 bg-emerald-400 rounded-full"/>æ­£ä½è§£è®€</h4><CardDetailGrid card={card} isReversed={false} /></div>
                                <div className="pt-6 border-t border-white/5"><h4 className="text-sm md:text-base font-bold mb-6 text-rose-400 flex items-center gap-2 uppercase tracking-widest"><span className="w-2.5 h-2.5 bg-rose-400 rounded-full"/>é€†ä½è§£è®€</h4><CardDetailGrid card={card} isReversed={true} /></div>
                            </div>
                        )}
                    </div>
                );
            };

            const MessageModal = () => message && (
                <div className="fixed inset-0 z-[300] flex items-center justify-center p-6 bg-black/60 backdrop-blur-sm animate-in no-select">
                    <div className="w-full max-w-xs bg-slate-900 border border-white/10 rounded-[2.5rem] p-8 space-y-6 text-center shadow-2xl">
                        <Icon name="AlertCircle" className={`mx-auto ${message.type==='error'?'text-rose-400':'text-emerald-400'}`} size={32} />
                        <p className="text-base text-white/80 leading-relaxed font-light">{message.text}</p>
                        <button onClick={() => setMessage(null)} className="w-full py-4 bg-white text-slate-900 rounded-full font-bold uppercase tracking-widest text-xs active:scale-95 transition-all">ç¢ºå®š</button>
                    </div>
                </div>
            );

            return (
                <div className={`min-h-screen ${themeStyles.bg} ${themeStyles.text} transition-colors duration-1000 pb-32 relative`}>
                    <MessageModal />
                    <div className="decoration-layer fixed inset-0 opacity-20 no-select">
                        <div className={`absolute top-[-10%] left-[-10%] w-[80%] h-[40%] ${themeStyles.glow1} rounded-full blur-[120px] transition-colors duration-1000`} />
                        <div className={`absolute bottom-[-10%] right-[-10%] w-[80%] h-[40%] ${themeStyles.glow2} rounded-full blur-[120px] transition-colors duration-1000`} />
                    </div>

                    {zoomedImage && (
                        <div className="fixed inset-0 z-[200] bg-black/95 flex items-center justify-center p-4 no-select" onClick={() => setZoomedImage(null)}>
                            <img src={zoomedImage} className="max-w-full max-h-full rounded-2xl shadow-2xl animate-in" alt="Tarot" />
                            <button className="absolute top-10 right-10 text-white/50" onClick={() => setZoomedImage(null)}><Icon name="X" size={40} /></button>
                        </div>
                    )}

                    <div className="relative z-10 max-w-5xl mx-auto px-6 py-10 md:py-16">
                        <header className="flex justify-between items-center mb-12 md:mb-16 no-select">
                            <div className="flex items-center gap-3 cursor-pointer" onClick={handleSecretClick}>
                                <div className="p-2.5 rounded-2xl bg-white/20 transition-colors"><Icon name={isChiMode ? "Heart" : "Sparkles"} className={isChiMode ? "animate-pulse text-white" : "text-amber-300"} size={26} /></div>
                                <h1 className="text-2xl md:text-3xl font-serif font-bold tracking-widest">{isChiMode ? "å¤§é˜¿çˆ¾å…‹ç´ ï¼† Chiikawa" : "å¤§é˜¿çˆ¾å…‹ç´"}</h1>
                            </div>
                            <div className="flex gap-3">
                                {isChiMode && <button onClick={() => setTheme('night')} className="w-12 h-12 rounded-full flex items-center justify-center border bg-white/10 shadow-sm btn-press transition-all"><Icon name="LogOut" size={18} /></button>}
                                <button onClick={toggleTheme} className="w-12 h-12 rounded-full flex items-center justify-center border bg-white/10 shadow-sm btn-press transition-all shadow-lg">
                                    {theme === 'chiikawa-pink' ? <Icon name="ChiikawaHead" size={32} /> :
                                     theme === 'chiikawa-blue' ? <Icon name="HachiwareHead" size={32} /> :
                                     theme === 'chiikawa-yellow' ? <Icon name="UsagiHead" size={32} /> :
                                     (theme === 'night' ? <Icon name="Moon" size={20} /> : <Icon name="Sun" size={20} />)}
                                </button>
                            </div>
                        </header>

                        {activeTab === 'divination' && (
                            <div className="animate-in">
                                {gameState === 'idle' && (
                                    <div className="space-y-12">
                                        <div className="md:max-w-3xl md:mx-auto space-y-10">
                                            <h2 className="text-4xl md:text-5xl font-serif font-bold leading-tight transition-colors duration-1000">ç¾åœ¨ï¼Œä½ æƒ³å•ä»€éº¼ï¼Ÿ</h2>
                                            
                                            {/* åŠ å¤§å­—é«”çš„éˆæ€§å¼•å°èª */}
                                            <div className="text-center py-6 md:py-10 animate-in">
                                                <p className={`text-2xl md:text-3xl font-serif italic tracking-wide ${themeStyles.text} opacity-80 leading-relaxed`}>
                                                    ã€Œè«‹æ·±å‘¼å¸ä¸‰æ¬¡ï¼Œå°‡æ€ç·’å°ˆæ³¨æ–¼æ‚¨çš„ç–‘æƒ‘ï¼Œè®“éˆæ€§æŒ‡å¼•åœ¨æ­¤æµ®ç¾ã€‚ã€
                                                </p>
                                            </div>

                                            <textarea 
                                                value={userQuestion} 
                                                onChange={e=>setUserQuestion(e.target.value)} 
                                                placeholder="åœ¨æ­¤è¼¸å…¥æ‚¨çš„å›°æƒ‘..." 
                                                className={`w-full h-40 md:h-48 ${themeStyles.inputBg} border ${themeStyles.inputBorder} ${themeStyles.focusBorder} rounded-[2.5rem] p-8 focus:outline-none transition-all resize-none shadow-xl text-lg md:text-xl placeholder:opacity-30 transition-colors duration-1000`} 
                                            />
                                            <div className="flex gap-4 md:gap-6">
                                                <button onClick={()=>setSpreadType('one')} className={`flex-1 p-6 md:p-8 rounded-[2rem] border-2 transition-all ${spreadType==='one' ? (isChiMode ? themeStyles.btnBg : 'border-indigo-400 bg-white/10 shadow-lg scale-105') : (themeStyles.inputBorder + ' opacity-40')}`}><Icon name="Compass" className="mx-auto mb-2 opacity-50" /><span className="text-sm md:text-base font-bold block uppercase tracking-widest no-select">ä¸€ç‰Œç›´è¦º</span></button>
                                                <button onClick={()=>setSpreadType('triangle')} className={`flex-1 p-6 md:p-8 rounded-[2rem] border-2 transition-all ${spreadType==='triangle' ? (isChiMode ? themeStyles.btnBg : 'border-indigo-400 bg-white/10 shadow-lg scale-105') : (themeStyles.inputBorder + ' opacity-40')}`}><Icon name="Layout" className="mx-auto mb-2 opacity-50" /><span className="text-sm md:text-base font-bold block uppercase tracking-widest no-select">è–ä¸‰è§’</span></button>
                                            </div>
                                            <button onClick={drawCards} className={`w-full py-7 md:py-8 ${themeStyles.btnBg} rounded-full font-bold tracking-[0.4em] shadow-2xl active:scale-95 transition-all text-xl md:text-2xl uppercase transition-colors duration-1000`}>å•Ÿå‹•éˆæ€§æ„Ÿæ‡‰</button>
                                        </div>
                                    </div>
                                )}

                                {gameState === 'shuffling' && (
                                    <div className="flex flex-col items-center justify-center min-h-[60vh] space-y-12 transition-colors duration-1000 no-select">
                                        <div className="relative w-40 h-60 md:w-52 md:h-72">
                                            {[...Array(6)].map((_, i) => (
                                                <div key={i} className={`absolute inset-0 ${themeStyles.cardBg} rounded-[2rem] border-2 ${themeStyles.inputBorder} shadow-2xl card-shuffle`} style={{ animationDelay: `${i*0.08}s`, zIndex: i }} />
                                            ))}
                                        </div>
                                        <p className="text-2xl md:text-3xl font-serif italic animate-pulse tracking-[0.3em] text-center">æ­£åœ¨æœå°‹å‘½é‹è»Œè·¡...</p>
                                    </div>
                                )}

                                {gameState === 'revealed' && (
                                    <div className="space-y-16 animate-in pb-10">
                                        <div className="flex flex-wrap justify-center gap-8 md:gap-12">
                                            {selectedCards.map((c, i) => (
                                                 <TarotCard key={i} card={c} idx={i} />
                                            ))}
                                        </div>

                                        <div className="space-y-10 md:max-w-4xl md:mx-auto">
                                            <div className="glass-panel rounded-[3rem] p-10 md:p-16 shadow-2xl relative overflow-hidden transition-colors duration-1000 min-h-[350px] border-white/10">
                                                <div className="flex items-center gap-3 mb-8 opacity-60 font-bold tracking-widest uppercase italic transition-colors duration-1000 text-base md:text-lg"><Icon name="BrainCircuit" size={24} />å®‡å®™çš„æ·±å±¤å•Ÿç¤º</div>
                                                {isAiLoading ? (<div className="flex flex-col items-center justify-center py-20 gap-4 text-center transition-colors duration-1000"><Icon name="RefreshCw" className="animate-spin opacity-30" size={40} /><p className="animate-pulse text-base opacity-40 tracking-widest font-serif">åŒæ­¥èƒ½é‡ä¸­...</p></div>) : aiResponse ? (
                                                    <div className="leading-relaxed font-light text-justify whitespace-pre-wrap text-lg md:text-xl animate-in transition-colors duration-1000">{aiResponse}</div>
                                                ) : !isAuthenticated ? (
                                                    <div className="py-10 flex flex-col items-center gap-8 animate-in">
                                                        <Icon name="Lock" size={56} className="opacity-20" />
                                                        <div className="text-center space-y-2 mb-6 text-sm md:text-base opacity-50 transition-colors duration-1000"><p>å•Ÿç¤ºå…§å®¹å·²é–å®š</p><p className="text-[10px] uppercase font-bold tracking-widest">è«‹è¼¸å…¥å¯†ç¢¼ä»¥è§£é–</p></div>
                                                        <div className="flex flex-col w-full gap-5 px-4 max-w-xs mb-16">
                                                            <input type="text" value={unlockPassInput} onChange={e=>setUnlockPassInput(e.target.value)} placeholder="è¨ªå•å¯†ç¢¼" className={`w-full ${themeStyles.inputBg} border ${themeStyles.inputBorder} rounded-2xl p-5 text-center text-lg focus:outline-none ${themeStyles.focusBorder} shadow-inner transition-all duration-1000`} />
                                                            <button onClick={handleUnlock} className={`w-full py-5 ${themeStyles.btnBg} rounded-full font-bold text-sm shadow-xl active:bg-indigo-50 uppercase tracking-widest transition-all`}>è§£é–å•Ÿç¤ºå…§å®¹</button>
                                                        </div>
                                                    </div>
                                                ) : <div className="text-center py-20 opacity-30 italic text-sm">åŒæ­¥ä¸­...</div>}
                                            </div>
                                            
                                            {selectedCards.map((c, i) => (
                                                <div key={i} className={`p-10 md:p-12 rounded-[3.5rem] border ${themeStyles.border} ${themeStyles.inputBg} space-y-10 shadow-lg animate-in transition-all duration-1000`} style={{animationDelay: `${i*100}ms`}}>
                                                    <div className="flex flex-col md:flex-row md:justify-between md:items-center gap-5">
                                                        <h4 className="font-bold text-2xl md:text-3xl flex items-center gap-3 transition-colors duration-1000">
                                                            <span className="w-2.5 h-2.5 bg-current opacity-30 rounded-full" />
                                                            {c.title} ( {c.isReversed?'é€†ä½':'æ­£ä½'} )
                                                        </h4>
                                                        <div className="flex flex-wrap gap-2.5 opacity-90">
                                                            {c.keywords.map((kw, idx) => (
                                                                <span key={idx} className="text-xs md:text-sm font-bold bg-indigo-500/20 text-indigo-400 px-4 py-2 rounded-full border border-indigo-500/10">#{kw}</span>
                                                            ))}
                                                        </div>
                                                    </div>
                                                    <CardDetailGrid card={c} isReversed={c.isReversed} />
                                                </div>
                                            ))}
                                            <div className="flex flex-col gap-6 pt-10 mb-24"><button onClick={resetGame} className={`w-full py-6 border-2 ${themeStyles.border} rounded-full text-lg font-bold flex items-center justify-center gap-3 active:scale-95 transition-all uppercase tracking-widest opacity-60 transition-colors`}><Icon name="RefreshCw" size={24} /> é‡æ–°å åœ</button></div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        {activeTab === 'guide' && (
                            <div className="animate-in space-y-16 pb-10">
                                <section className="space-y-8 no-select">
                                    <h2 className="text-3xl md:text-4xl font-serif font-bold tracking-widest transition-colors duration-1000">ä½¿ç”¨æ•™å­¸</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-5">
                                        {[
                                            { step: "01", title: "éœå¿ƒæ²‰æ¾±", desc: "é–‰ä¸Šé›™çœ¼ï¼Œæ·±å‘¼å¸å¹¾æ¬¡ï¼Œè®“å…§å¿ƒå¹³éœä¸‹ä¾†ã€‚" },
                                            { step: "02", title: "æ˜ç¢ºæå•", desc: "åœ¨å¿ƒä¸­æƒ³è‘—ä¸€å€‹å…·é«”çš„å•é¡Œæˆ–ç›®å‰çš„ç–‘æƒ‘ã€‚" },
                                            { step: "03", title: "é¸æ“‡ç‰Œé™£", desc: "è¦–å•é¡Œé¸æ“‡ä¸€ç‰Œç›´è¦ºæˆ–åˆ†æéå»æœªä¾†çš„è–ä¸‰è§’ã€‚" },
                                            { step: "04", title: "éˆæ€§æ„Ÿæ‡‰", desc: "å•Ÿå‹•æ„Ÿæ‡‰ï¼Œè®“ç³»çµ±é€£çµç•¶ä¸‹çš„å®‡å®™é »ç‡ã€‚" },
                                            { step: "05", title: "é–±è®€å•Ÿç¤º", desc: "è§£é–è©³ç´°å…§å®¹ï¼Œçµåˆé—œéµå­—èˆ‡ AI æ™ºæ…§é€²è¡Œæ€ç´¢ã€‚" }
                                        ].map((item, i) => (
                                            <div key={i} className={`${themeStyles.cardBg} border ${themeStyles.inputBorder} p-8 rounded-[2.5rem] flex flex-col gap-5 shadow-sm hover:shadow-md transition-all`}>
                                                <span className="text-3xl font-serif font-bold opacity-10 leading-none">{item.step}</span>
                                                <div className="space-y-1.5">
                                                    <h4 className="font-bold text-base md:text-lg tracking-widest transition-colors duration-1000">{item.title}</h4>
                                                    <p className="text-[13px] opacity-60 leading-relaxed font-light transition-colors duration-1000">{item.desc}</p>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </section>

                                <section className="space-y-8">
                                    <div className="flex items-center gap-3 no-select">
                                        <Icon name="BookOpen" size={24} className="opacity-50" />
                                        <h3 className="font-bold text-xl md:text-2xl border-l-4 border-indigo-500 pl-3 uppercase tracking-widest transition-colors duration-1000">å¤§é˜¿çˆ¾å…‹é‚£åœ–é‘‘</h3>
                                    </div>
                                    <div className="grid grid-cols-1 gap-5">
                                        {TAROT_DATA.map(card => (
                                            <EncyclopediaCard key={card.id} card={card} />
                                        ))}
                                    </div>
                                </section>
                                
                                <section className="space-y-4 pt-10 border-t border-white/5 no-select">
                                    <button onClick={() => setIsShareLinkOpen(!isShareLinkOpen)} className="w-full py-5 glass-panel rounded-3xl flex items-center justify-center gap-3 opacity-40 hover:opacity-100 transition-all text-xs font-bold uppercase tracking-widest">
                                        <Icon name="Share" size={16} /> æˆæ¬Šåˆ†äº«é€£çµè¨­å®š
                                        <Icon name="ChevronDown" size={14} className={`transition-transform duration-300 ${isShareLinkOpen ? 'rotate-180' : ''}`} />
                                    </button>
                                    {isShareLinkOpen && (
                                        <div className="animate-in glass-panel p-10 rounded-[3rem] border-indigo-500/20 space-y-6 shadow-xl text-center md:text-left">
                                            <p className="font-bold text-indigo-400 text-lg uppercase tracking-widest">åŠ å¯†æˆæ¬Šé€£çµ</p>
                                            <p className="text-sm opacity-70 leading-relaxed italic">ç®¡ç†å“¡åœ¨è¨­å®šå¥½çš„è£ç½®ç”Ÿæˆæ­¤é€£çµä¸¦å‚³çµ¦è¦ªå‹ã€‚è¦ªå‹æ‰‹æ©Ÿé–‹å•Ÿå¾Œå³å¯æ°¸ä¹…é€£ç·šæ‚¨çš„é‡‘é‘°ç³»çµ±ã€‚</p>
                                            <button onClick={() => {
                                                if (!masterApiKey || !masterPass) { setMessage({text: "è«‹å…ˆå®Œæˆç®¡ç†å“¡åŠ å¯†è¨­å®šã€‚", type: 'error'}); return; }
                                                const encrypted = encodeKey(masterApiKey, masterPass);
                                                const url = `${window.location.origin}${window.location.pathname}?auth=${encrypted}`;
                                                const el = document.createElement('textarea'); el.value = url;
                                                document.body.appendChild(el); el.select();
                                                document.execCommand('copy'); document.body.removeChild(el);
                                                setMessage({text: "æˆæ¬Šé€£çµå·²è¤‡è£½ï¼å‚³çµ¦è¦ªå‹é»é–‹å³å¯ã€‚", type: 'success'});
                                            }} className={`px-10 py-5 ${themeStyles.btnBg} rounded-full text-[11px] font-bold active:scale-95 transition-all flex items-center justify-center md:justify-start gap-2 shadow-2xl mx-auto md:mx-0`}>
                                                <Icon name="Share" size={18} /> ç”Ÿæˆå°ˆå±¬æˆæ¬Šé€£çµ
                                            </button>
                                        </div>
                                    )}
                                </section>

                                <button onClick={() => setIsSetupVisible(true)} className="w-full py-4 border border-dashed border-white/10 rounded-2xl opacity-10 text-[10px] hover:opacity-100 transition-all font-bold uppercase tracking-widest no-select">ç®¡ç†å“¡å°ˆå€</button>
                            </div>
                        )}
                    </div>

                    <nav className={`fixed bottom-0 left-0 w-full bg-slate-900/95 backdrop-blur-2xl border-t border-white/10 px-12 py-8 flex justify-around items-center z-50 shadow-[0_-10px_30px_rgba(0,0,0,0.3)] transition-colors duration-1000 no-select`}>
                        <button onClick={()=>setActiveTab('divination')} className={`flex flex-col items-center gap-1.5 transition-all ${activeTab==='divination'?'opacity-100 scale-110' : 'opacity-30'}`} style={{color: activeTab === 'divination' ? themeStyles.accent : '#64748b'}}><Icon name="Sparkles" size={30} /><span className="text-[12px] font-bold mt-1 uppercase tracking-widest">å åœ</span></button>
                        <button onClick={()=>setActiveTab('guide')} className={`flex flex-col items-center gap-1.5 transition-all ${activeTab==='guide'?'opacity-100 scale-110' : 'opacity-30'}`} style={{color: activeTab === 'guide' ? themeStyles.accent : '#64748b'}}><Icon name="BookOpen" size={30} /><span className="text-[12px] font-bold mt-1 uppercase tracking-widest">æŒ‡å—</span></button>
                    </nav>

                    {isSetupVisible && (
                        <div className="fixed inset-0 z-[200] flex items-center justify-center p-6 bg-black/95 backdrop-blur-md no-select">
                            <div className="w-full max-w-sm glass-panel rounded-[3.5rem] p-10 space-y-10 shadow-2xl border-white/10">
                                <div className="text-center space-y-2"><h3 className="text-2xl font-serif font-bold transition-colors duration-1000">ç®¡ç†åŠ å¯†è¨­å®š</h3></div>
                                <div className="space-y-5 text-left">
                                    <div className="space-y-1.5"><label className="text-[10px] opacity-40 ml-2 uppercase font-bold tracking-widest">Gemini API Key</label><input type="password" value={masterApiKey} onChange={e=>setMasterApiKey(e.target.value)} placeholder="API Key" className={`w-full ${themeStyles.inputBg} border ${themeStyles.inputBorder} rounded-2xl p-4 text-base focus:outline-none shadow-inner transition-colors duration-1000`} /></div>
                                    <div className="space-y-1.5"><label className="text-[10px] opacity-40 ml-2 uppercase font-bold tracking-widest">è¨­å®šè§£é–å¯†ç¢¼</label><input type="text" value={masterPass} onChange={e=>setMasterPass(e.target.value)} placeholder="è§£é–å¯†ç¢¼" className={`w-full ${themeStyles.inputBg} border ${themeStyles.inputBorder} rounded-2xl p-4 text-base focus:outline-none shadow-inner transition-colors duration-1000`} /></div>
                                </div>
                                <button onClick={handleSaveMaster} className="w-full py-5 bg-white text-slate-900 rounded-full font-bold shadow-xl active:scale-95 transition-all uppercase text-[10px] tracking-widest font-bold">å„²å­˜æœ¬åœ°è¨­å®š</button>
                                <button onClick={() => setIsSetupVisible(false)} className="w-full text-[10px] opacity-30 mt-4 font-bold tracking-widest uppercase text-center">å–æ¶ˆ</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
